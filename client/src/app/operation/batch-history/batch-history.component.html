<div class="container-fluid">
    <div class="row my-2">
        <div class="col-lg-6">
            <form (ngSubmit)="searchHistory($event, searchQuery.value)">
                <div class="row">
                    <div class="col-lg-6">
                        <input class="form-control" type="search" #searchQuery>
                    </div>
                    <div class="col-lg-4">

                        <button type="submit" value="Search" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-lg-2 offset-lg-4" *ngIf="queryResponse; else loading">
            <button class="btn btn-outline-primary w-50 float-left" (click)="goPrevious()" [disabled]="!queryResponse.previous">Previous</button>
            <button class="btn btn-outline-primary w-50 float-right" (click)="goNext()" [disabled]="!queryResponse.next">Next</button>
        </div>
    </div>


    <div *ngIf="queryResponse">
        <div *ngIf="queryResponse.count != 0; else noContent">

            <table class="table table-bordered rounded">
                <tbody>
                    <tr *ngFor="let batch of batches" class="align-items-center justify-content-center">
                        <th scope="row" class="text-center align-middle">
                            # {{ batch.batch_number }}
                        </th>
                        <td scope="col" class="align-middle">
                            <ul>
                                <li>
                                    Order: <b>{{ batch.order.order_number }}</b>
                                </li>
                                <li>
                                    Article number: <b>{{ batch.order.article_number }}</b>
                                </li>
                                <li *ngIf="batch.end_date && batch.rework_date">
                                    Status:
                                    <label class="p-1 font-weight-bold bg-success-light rounded">Reworked</label>
                                </li>
                                <li *ngIf="batch.end_date && !batch.rework_date">
                                    Status:
                                    <label class="p-1 font-weight-bold bg-warning-light rounded">Finished</label>
                                </li>
                                <li *ngIf="!batch.end_date && !batch.rework_date">
                                    Status:
                                    <label class="p-1 font-weight-bold bg-primary-light rounded">Running</label>
                                </li>
                            </ul>
                        </td>
                        <td scope="col" class="align-middle">
                            <ul>
                                <li>
                                    Start Date:
                                    <b>{{ batch.start_date | date:"yyyy-MM-dd HH:mm" }}</b>
                                </li>
                                <li>
                                    End Date:
                                    <b>{{ batch.end_date | date:"yyyy-MM-dd HH:mm" }}</b>
                                </li>
                                <li>
                                    Yield:
                                    <b>{{ batch.production_yield }}</b>
                                </li>
                            </ul>
                        </td>
                        <td scope="col" class="text-center align-middle">
                            <a (click)="toBatchDetail(batch.id)" class="btn btn-primary">Details</a>
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <br>
</div>

<ng-template #noContent>
    No Batches found...
</ng-template>

<!-- If user is loaded show the form, else show the loading template -->
<ng-template #loading>
    Loading content...
</ng-template>